## ğŸ—ï¸ Arquitetura Geral do Sistema

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                    SISTEMA IoT DASHBOARD - MVC                    â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      HARDWARE LAYER                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  ESP32 (Microcontrolador)                                 â”‚  â”‚
â”‚  â”‚  â”œâ”€â”€ DHT22 (Temperatura & Umidade)                        â”‚  â”‚
â”‚  â”‚  â”œâ”€â”€ LDR (Sensor de Luminosidade)                         â”‚  â”‚
â”‚  â”‚  â”œâ”€â”€ HC-SR501 (Sensor de PresenÃ§a)                        â”‚  â”‚
â”‚  â”‚  â”œâ”€â”€ RFID-RC522 (Leitor de Tags)                          â”‚  â”‚
â”‚  â”‚  â”œâ”€â”€ RelÃ©s (Controle On/Off)                              â”‚  â”‚
â”‚  â”‚  â””â”€â”€ PWM (Controle Proporcional)                          â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚ WiFi
                           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   FIREBASE REALTIME DATABASE                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  /sensores/dados                                         â”‚   â”‚
â”‚  â”‚  /climatizador/estado                                    â”‚   â”‚
â”‚  â”‚  /comandos/iluminacao                                    â”‚   â”‚
â”‚  â”‚  /comandos/climatizador                                  â”‚   â”‚
â”‚  â”‚  /preferencias/request                                   â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚ HTTP/HTTPS
                           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      VIEW LAYER (UI)                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  MenuInterfaceSimple                                     â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€ Dashboard em Tempo Real                             â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€ Controles de ClimatizaÃ§Ã£o                           â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€ Controles de IluminaÃ§Ã£o                             â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€ VisualizaÃ§Ã£o de HistÃ³rico                           â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€ Gerenciamento de FuncionÃ¡rios                       â”‚   â”‚
â”‚  â”‚  â””â”€â”€ VisualizaÃ§Ã£o de Logs                                â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
                           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    CONTROLLER LAYER                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  SistemaIotController (Orquestrador Central)            â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€ Gerenciamento de Streams                            â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€ Processamento de Dados de Sensores                  â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€ LÃ³gica de PreferÃªncias de Grupo                     â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€ CoordenaÃ§Ã£o de Services                             â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€ CoordenaÃ§Ã£o de DAOs                                 â”‚   â”‚
â”‚  â”‚  â””â”€â”€ Background Processing                               â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚                          â”‚
     â–¼                          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   SERVICE LAYER     â”‚   â”‚      DAO LAYER                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚FirebaseService â”‚ â”‚   â”‚  â”‚ FuncionarioDao               â”‚  â”‚
â”‚  â”‚ - Polling      â”‚ â”‚   â”‚  â”‚ - CRUD FuncionÃ¡rios          â”‚  â”‚
â”‚  â”‚ - Streams      â”‚ â”‚   â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚  â”‚ - HTTP Client  â”‚ â”‚   â”‚  â”‚ HistoricoDao                 â”‚  â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚   â”‚  â”‚ - CRUD Dados HistÃ³ricos      â”‚  â”‚
â”‚  â”‚Funcionario     â”‚ â”‚   â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚  â”‚Service         â”‚ â”‚   â”‚  â”‚ LogDao                       â”‚  â”‚
â”‚  â”‚ - Buscar Func. â”‚ â”‚   â”‚  â”‚ - CRUD Logs Sistema          â”‚  â”‚
â”‚  â”‚ - PreferÃªncias â”‚ â”‚   â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚   â”‚  â”‚ PreferenciaTagDao            â”‚  â”‚
â”‚  â”‚LogService      â”‚ â”‚   â”‚  â”‚ - CRUD PreferÃªncias          â”‚  â”‚
â”‚  â”‚ - Registro     â”‚ â”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”‚ - NÃ­veis       â”‚ â”‚   â”‚               â”‚                    â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚   â”‚               â–¼                    â”‚
â”‚  â”‚SaidaService    â”‚ â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ - Buffer       â”‚ â”‚   â”‚  â”‚ DatabaseConnection           â”‚  â”‚
â”‚  â”‚ - FormataÃ§Ã£o   â”‚ â”‚   â”‚  â”‚ - Pool de ConexÃµes           â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   â”‚  â”‚ - TransaÃ§Ãµes                 â”‚  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                       â”‚
                                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      MODEL LAYER                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚DadosSensores  â”‚  â”‚Estado-       â”‚  â”‚Funcionario       â”‚     â”‚
â”‚  â”‚- temperatura  â”‚  â”‚Climatizador  â”‚  â”‚- id              â”‚     â”‚
â”‚  â”‚- humidade     â”‚  â”‚- temperatura â”‚  â”‚- nome            â”‚     â”‚
â”‚  â”‚- luminosidade â”‚  â”‚- modo        â”‚  â”‚- tag_rfid        â”‚     â”‚
â”‚  â”‚- ldr          â”‚  â”‚- velocidade  â”‚  â”‚- grupo           â”‚     â”‚
â”‚  â”‚- pessoas      â”‚  â”‚- status      â”‚  â”‚- ativo           â”‚     â”‚
â”‚  â”‚- tags         â”‚  â”‚- timestamp   â”‚  â”‚- created_at      â”‚     â”‚
â”‚  â”‚- timestamp    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚  â”‚- dadosValidos â”‚                                              â”‚
â”‚  â”‚- iluminacao   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚LogEntry      â”‚  â”‚Preferencias-     â”‚     â”‚
â”‚                     â”‚- tipo        â”‚  â”‚Grupo             â”‚     â”‚
â”‚                     â”‚- mensagem    â”‚  â”‚- tag_rfid        â”‚     â”‚
â”‚                     â”‚- timestamp   â”‚  â”‚- tempIdeal       â”‚     â”‚
â”‚                     â”‚- contexto    â”‚  â”‚- tempMin/Max     â”‚     â”‚
â”‚                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚- ilumMin         â”‚     â”‚
â”‚                                       â”‚- prioridade      â”‚     â”‚
â”‚                                       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
                           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      MYSQL DATABASE                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Tables:                                                 â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€ funcionarios                                        â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€ dados_historicos                                    â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€ logs                                                â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€ preferencias_tags                                   â”‚   â”‚
â”‚  â”‚  â””â”€â”€ routines                                            â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”„ Fluxo de Dados - Leitura de Sensores

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ESP32   â”‚  1. Leitura de sensores a cada ciclo
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
     â”‚ PUT /sensores/dados
     â”‚ {temperatura, umidade, luminosidade, tags, ...}
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Firebase RT DB â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚ Polling HTTP GET (5 segundos)
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚FirebaseService  â”‚  2. Recebe dados via HTTP
â”‚  (Stream)       â”‚     Converte JSON â†’ DadosSensores
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     Emite via Stream
     â”‚
     â”‚ Stream<DadosSensores>
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚SistemaIotController  â”‚  3. Processa dados
â”‚                      â”‚     - Valida informaÃ§Ãµes
â”‚  [Processar]         â”‚     - Verifica tags RFID
â”‚   â”œâ”€ Validar        â”‚     - Calcula preferÃªncias
â”‚   â”œâ”€ Tags?          â”‚     - Prepara comando
â”‚   â”œâ”€ PreferÃªncias   â”‚
â”‚   â””â”€ Gerar Comando   â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚         â”‚
     â”‚         â”‚ 4. Salvar dados
     â”‚         â–¼
     â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚    â”‚HistoricoDao  â”‚
     â”‚    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚           â”‚ INSERT
     â”‚           â–¼
     â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚    â”‚    MySQL     â”‚
     â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â”‚ 5. Atualizar interface
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚MenuInterface   â”‚
â”‚  [Dashboard]   â”‚
â”‚  - Temp: 25Â°C  â”‚
â”‚  - Umid: 60%   â”‚
â”‚  - Luz: 450    â”‚
â”‚  - Pessoas: 2  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## âš™ï¸ Fluxo de AplicaÃ§Ã£o de PreferÃªncias

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ESP32   â”‚  1. Tags RFID detectadas
â”‚  [RFID]  â”‚     [TAG123, TAG456]
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
     â”‚ PUT /sensores/dados {tags: [...]}
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Firebase RT DB â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚SistemaIotController  â”‚  2. Detecta novas tags
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â”‚ buscarPorTags([TAG123, TAG456])
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚FuncionarioService  â”‚  3. Busca funcionÃ¡rios e preferÃªncias
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â”œâ”€â”€â”€ buscarPorTag(TAG123) â”€â”€â”€â”€â”
     â”‚                             â”‚
     â””â”€â”€â”€ buscarPorTag(TAG456) â”€â”€â”€â”€â”¤
                                   â–¼
                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                          â”‚  FuncionarioDao  â”‚
                          â”‚  PreferenciaDao  â”‚
                          â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â”‚ SELECT
                               â–¼
                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                          â”‚      MySQL       â”‚
                          â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â”‚
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚                                               â”‚
      â–¼                                               â–¼
 FuncionÃ¡rio A                                  FuncionÃ¡rio B
 Grupo: GerÃªncia                                Grupo: TI
 Prioridade: 3                                  Prioridade: 2
 Temp Ideal: 22Â°C                               Temp Ideal: 24Â°C
                               â”‚
                               â”‚ 4. Calcular preferÃªncia Ã³tima
                               â”‚    MÃ©dia ponderada por prioridade
                               â–¼
                     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                     â”‚ ConfiguraÃ§Ã£o Ideal   â”‚
                     â”‚ Temperatura: 23Â°C    â”‚
                     â”‚ Modo: Auto           â”‚
                     â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â”‚ 5. Enviar comando
                            â–¼
                     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                     â”‚FirebaseService   â”‚
                     â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚ PUT /comandos/climatizador
                            â–¼
                     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                     â”‚ Firebase RT DB   â”‚
                     â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â–¼
                     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                     â”‚     ESP32        â”‚
                     â”‚  [Aplicar Config]â”‚
                     â”‚   Temp â†’ 23Â°C    â”‚
                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ›ï¸ Fluxo de Comando Manual

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚MenuInterface   â”‚  1. UsuÃ¡rio escolhe comando
â”‚  [Menu]        â”‚     Ex: Definir temperatura 25Â°C
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚ enviarComandoClimatizador({temp: 25, modo: "manual"})
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚SistemaIotController  â”‚  2. Valida e processa comando
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚                            â”‚
     â”‚ Enviar Comando             â”‚ Registrar Log
     â–¼                            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚FirebaseService  â”‚         â”‚LogServiceâ”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
     â”‚                           â”‚
     â”‚ PUT comando               â”‚ INSERT log
     â–¼                           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚Firebase RT DB   â”‚         â”‚  MySQL   â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â”‚ ESP32 busca comando
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     ESP32       â”‚  3. Executa comando
â”‚  [Executar]     â”‚     Ajusta temperatura
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“Š Estrutura de Pastas

```
pi-mds/
â”‚
â”œâ”€â”€ bin/                          # Ponto de entrada
â”‚   â””â”€â”€ main.dart                 # Bootstrap da aplicaÃ§Ã£o
â”‚
â”œâ”€â”€ lib/                          # CÃ³digo fonte principal
â”‚   â”‚
â”‚   â”œâ”€â”€ config/                   # ConfiguraÃ§Ãµes
â”‚   â”‚   â”œâ”€â”€ database_config.dart
â”‚   â”‚   â””â”€â”€ firebase_config.dart
â”‚   â”‚
â”‚   â”œâ”€â”€ models/                   # MODEL - Entidades
â”‚   â”‚   â”œâ”€â”€ dados_sensores.dart
â”‚   â”‚   â”œâ”€â”€ estado_climatizador.dart
â”‚   â”‚   â”œâ”€â”€ funcionario.dart
â”‚   â”‚   â”œâ”€â”€ log_entry.dart
â”‚   â”‚   â””â”€â”€ preferencias_grupo.dart
â”‚   â”‚
â”‚   â”œâ”€â”€ controllers/              # CONTROLLER - LÃ³gica
â”‚   â”‚   â””â”€â”€ sistema_iot_controller.dart
â”‚   â”‚
â”‚   â”œâ”€â”€ ui/                       # VIEW - Interface
â”‚   â”‚   â””â”€â”€ menu_interface_simple.dart
â”‚   â”‚
â”‚   â”œâ”€â”€ services/                 # ServiÃ§os
â”‚   â”‚   â”œâ”€â”€ firebase_service.dart
â”‚   â”‚   â”œâ”€â”€ funcionario_service.dart
â”‚   â”‚   â”œâ”€â”€ log_service.dart
â”‚   â”‚   â””â”€â”€ saida_service.dart
â”‚   â”‚
â”‚   â”œâ”€â”€ dao/                      # Data Access Objects
â”‚   â”‚   â”œâ”€â”€ funcionario_dao.dart
â”‚   â”‚   â”œâ”€â”€ historico_dao.dart
â”‚   â”‚   â”œâ”€â”€ log_dao.dart
â”‚   â”‚   â””â”€â”€ preferencia_tag_dao.dart
â”‚   â”‚
â”‚   â”œâ”€â”€ database/                 # Gerenciamento BD
â”‚   â”‚   â””â”€â”€ database_connection.dart
â”‚   â”‚
â”‚   â””â”€â”€ utils/                    # UtilitÃ¡rios
â”‚       â””â”€â”€ console.dart
â”‚
â”œâ”€â”€ hardware/                     # CÃ³digo ESP32
â”‚   â””â”€â”€ esp32_main.ino
â”‚
â”œâ”€â”€ docs/                         # ğŸ“š DOCUMENTAÃ‡ÃƒO
â”‚   â”œâ”€â”€ README.md                 # Ãndice
â”‚   â”œâ”€â”€ PLANEJAMENTO_RESUMO.md    # Resumo executivo
â”‚   â”œâ”€â”€ ARQUITETURA_MVC.md        # Arquitetura completa
â”‚   â”œâ”€â”€ DIAGRAMAS_MERMAID.md      # Diagramas Mermaid
â”‚   â”œâ”€â”€ DIAGRAMAS_ASCII.md        # Este arquivo
â”‚   â”œâ”€â”€ arquitetura_sistema.puml
â”‚   â”œâ”€â”€ diagrama_classes.puml
â”‚   â””â”€â”€ fluxo_dados_sensores.puml
â”‚
â”œâ”€â”€ test/                         # Testes
â”‚
â”œâ”€â”€ example/                      # Exemplos
â”‚   â””â”€â”€ stream_examples.dart
â”‚
â”œâ”€â”€ Dump20251016/                # Backup MySQL
â”‚
â”œâ”€â”€ pubspec.yaml                 # DependÃªncias
â””â”€â”€ analysis_options.yaml        # ConfiguraÃ§Ã£o lint
```

---

## ğŸ—ƒï¸ Banco de Dados MySQL

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              BANCO: pi_iot_system               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  TABELA: funcionarios                                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Campo          â”‚ Tipo         â”‚ DescriÃ§Ã£o                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id (PK)        â”‚ INT          â”‚ ID Ãºnico                     â”‚
â”‚ nome           â”‚ VARCHAR(100) â”‚ Nome completo                â”‚
â”‚ tag_rfid (UK)  â”‚ VARCHAR(50)  â”‚ Tag RFID Ãºnica               â”‚
â”‚ grupo          â”‚ VARCHAR(50)  â”‚ Grupo/Departamento           â”‚
â”‚ ativo          â”‚ BOOLEAN      â”‚ Status ativo                 â”‚
â”‚ created_at     â”‚ TIMESTAMP    â”‚ Data de criaÃ§Ã£o              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  TABELA: dados_historicos                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Campo          â”‚ Tipo         â”‚ DescriÃ§Ã£o                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id (PK)        â”‚ INT          â”‚ ID Ãºnico                     â”‚
â”‚ temperatura    â”‚ DOUBLE       â”‚ Temperatura em Â°C            â”‚
â”‚ humidade       â”‚ DOUBLE       â”‚ Umidade em %                 â”‚
â”‚ luminosidade   â”‚ INT          â”‚ Luminosidade                 â”‚
â”‚ ldr            â”‚ INT          â”‚ Valor LDR                    â”‚
â”‚ pessoas        â”‚ INT          â”‚ Contador de pessoas          â”‚
â”‚ tags           â”‚ JSON         â”‚ Array de tags RFID           â”‚
â”‚ timestamp      â”‚ TIMESTAMP    â”‚ Data/hora da leitura         â”‚
â”‚ iluminacao_art â”‚ INT          â”‚ IluminaÃ§Ã£o artificial        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  TABELA: logs                                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Campo          â”‚ Tipo         â”‚ DescriÃ§Ã£o                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id (PK)        â”‚ INT          â”‚ ID Ãºnico                     â”‚
â”‚ tipo           â”‚ VARCHAR(20)  â”‚ INFO/WARNING/ERROR/COMMAND   â”‚
â”‚ mensagem       â”‚ TEXT         â”‚ Mensagem do log              â”‚
â”‚ timestamp      â”‚ TIMESTAMP    â”‚ Data/hora                    â”‚
â”‚ contexto       â”‚ JSON         â”‚ Contexto adicional           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  TABELA: preferencias_tags                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Campo          â”‚ Tipo         â”‚ DescriÃ§Ã£o                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ tag_rfid (PK)  â”‚ VARCHAR(50)  â”‚ Tag RFID                     â”‚
â”‚ temp_ideal     â”‚ DOUBLE       â”‚ Temperatura ideal            â”‚
â”‚ temp_min       â”‚ DOUBLE       â”‚ Temperatura mÃ­nima           â”‚
â”‚ temp_max       â”‚ DOUBLE       â”‚ Temperatura mÃ¡xima           â”‚
â”‚ ilum_minima    â”‚ INT          â”‚ IluminaÃ§Ã£o mÃ­nima            â”‚
â”‚ prioridade     â”‚ INT          â”‚ Prioridade (1-5)             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Relacionamentos:
funcionarios.tag_rfid â”€â”€< preferencias_tags.tag_rfid
```

---

## ğŸ”¥ Firebase Realtime Database

```
pi-iot-system/
â”‚
â”œâ”€â”€ sensores/
â”‚   â””â”€â”€ dados/
â”‚       â”œâ”€â”€ temperatura: 25.5
â”‚       â”œâ”€â”€ humidade: 60
â”‚       â”œâ”€â”€ luminosidade: 450
â”‚       â”œâ”€â”€ ldr: 750
â”‚       â”œâ”€â”€ pessoas: 2
â”‚       â”œâ”€â”€ tags: ["TAG123", "TAG456"]
â”‚       â”œâ”€â”€ timestamp: 1699123456789
â”‚       â”œâ”€â”€ dadosValidos: true
â”‚       â””â”€â”€ iluminacao_artificial: 50
â”‚
â”œâ”€â”€ climatizador/
â”‚   â””â”€â”€ estado/
â”‚       â”œâ”€â”€ temperatura: 24.5
â”‚       â”œâ”€â”€ temperatura_configuracao: 23.0
â”‚       â”œâ”€â”€ modo: "auto"
â”‚       â”œâ”€â”€ velocidade: 2
â”‚       â”œâ”€â”€ status: true
â”‚       â””â”€â”€ timestamp: 1699123456789
â”‚
â”œâ”€â”€ comandos/
â”‚   â”œâ”€â”€ iluminacao/
â”‚   â”‚   â”œâ”€â”€ comando: "auto"
â”‚   â”‚   â””â”€â”€ timestamp: 1699123456789
â”‚   â”‚
â”‚   â””â”€â”€ climatizador/
â”‚       â”œâ”€â”€ temperatura: 23
â”‚       â”œâ”€â”€ modo: "auto"
â”‚       â”œâ”€â”€ velocidade: 2
â”‚       â””â”€â”€ timestamp: 1699123456789
â”‚
â””â”€â”€ preferencias/
    â””â”€â”€ request/
        â”œâ”€â”€ tag_rfid: "TAG123"
        â””â”€â”€ timestamp: 1699123456789
```

---

## ğŸ”„ Ciclo de Vida do Sistema

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  INICIAR     â”‚
â”‚  SISTEMA     â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  1. Configurar MySQL         â”‚
â”‚     - Criar conexÃ£o          â”‚
â”‚     - Verificar/criar tables â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  2. Inicializar DAOs         â”‚
â”‚     - FuncionarioDao         â”‚
â”‚     - HistoricoDao           â”‚
â”‚     - LogDao                 â”‚
â”‚     - PreferenciaTagDao      â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  3. Inicializar Services     â”‚
â”‚     - FirebaseService        â”‚
â”‚     - FuncionarioService     â”‚
â”‚     - LogService             â”‚
â”‚     - SaidaService           â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  4. Criar Controller         â”‚
â”‚     - SistemaIotController   â”‚
â”‚     - Injetar dependÃªncias   â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  5. Iniciar Monitoramento    â”‚
â”‚     - Start polling          â”‚
â”‚     - Subscribe streams      â”‚
â”‚     - Background processing  â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  6. Exibir Menu              â”‚
â”‚     - Interface do usuÃ¡rio   â”‚
â”‚     - Loop principal         â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚  â”‚  Loop contÃ­nuo:   â”‚
       â””â”€>â”‚  - Processar dadosâ”‚
          â”‚  - Executar cmds  â”‚
          â”‚  - Atualizar UI   â”‚
          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“¦ DependÃªncias entre Componentes

```
MenuInterfaceSimple
    â”‚
    â””â”€â”€â”€ depends on â”€â”€â”€> SistemaIotController
                              â”‚
                              â”œâ”€â”€â”€ depends on â”€â”€â”€> FirebaseService
                              â”‚                         â”‚
                              â”‚                         â””â”€â”€â”€ uses â”€â”€â”€> FirebaseConfig
                              â”‚
                              â”œâ”€â”€â”€ depends on â”€â”€â”€> FuncionarioService
                              â”‚                         â”‚
                              â”‚                         â”œâ”€â”€â”€ depends on â”€â”€â”€> FuncionarioDao
                              â”‚                         â”‚                         â”‚
                              â”‚                         â”‚                         â””â”€â”€â”€ uses â”€â”€â”€> DatabaseConnection
                              â”‚                         â”‚
                              â”‚                         â””â”€â”€â”€ depends on â”€â”€â”€> PreferenciaTagDao
                              â”‚                                                     â”‚
                              â”‚                                                     â””â”€â”€â”€ uses â”€â”€â”€> DatabaseConnection
                              â”‚
                              â”œâ”€â”€â”€ depends on â”€â”€â”€> LogService
                              â”‚                         â”‚
                              â”‚                         â””â”€â”€â”€ depends on â”€â”€â”€> LogDao
                              â”‚                                                 â”‚
                              â”‚                                                 â””â”€â”€â”€ uses â”€â”€â”€> DatabaseConnection
                              â”‚
                              â””â”€â”€â”€ depends on â”€â”€â”€> HistoricoDao
                                                        â”‚
                                                        â””â”€â”€â”€ uses â”€â”€â”€> DatabaseConnection
                                                                            â”‚
                                                                            â””â”€â”€â”€ uses â”€â”€â”€> DatabaseConfig

Todos os Models:
    - DadosSensores
    - EstadoClimatizador
    - Funcionario
    - LogEntry
    - PreferenciasGrupo
    
SÃ£o utilizados por vÃ¡rias camadas (sem dependÃªncias)
```

---

## â±ï¸ Timeline de Processamento (5 segundos)

```
Tempo    AÃ§Ã£o
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
00:00    â”Œâ”€ Ciclo 1 Inicia
00:00    â”‚  ESP32 â†’ Ler sensores
00:00.5  â”‚  ESP32 â†’ PUT Firebase
00:01    â”‚  FirebaseService â†’ GET Firebase (polling)
00:01.1  â”‚  FirebaseService â†’ Stream emit dados
00:01.2  â”‚  Controller â†’ Processar dados
00:01.3  â”‚  Controller â†’ Buscar preferÃªncias (se tags)
00:01.5  â”‚  Controller â†’ Calcular comando
00:01.6  â”‚  Controller â†’ PUT comando Firebase
00:01.7  â”‚  Controller â†’ Salvar histÃ³rico MySQL
00:01.8  â”‚  Controller â†’ Atualizar UI
00:02    â”‚  ESP32 â†’ GET comando Firebase
00:02.1  â”‚  ESP32 â†’ Executar comando
         â””â”€ Ciclo 1 Completo
         
... aguardar ...

00:05    â”Œâ”€ Ciclo 2 Inicia
00:05    â”‚  ESP32 â†’ Ler sensores
00:05.5  â”‚  ESP32 â†’ PUT Firebase
...      â”‚  (processo se repete)
```

---

## ğŸ¯ PadrÃµes MVC Aplicados

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  MVC PATTERN                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

MODEL                    VIEW                    CONTROLLER
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
DadosSensores           MenuInterface-          SistemaIot-
EstadoClimatizador      Simple                  Controller
Funcionario               â”‚                        â”‚
LogEntry                  â”‚                        â”‚
PreferenciasGrupo         â”‚                        â”‚
                          â”‚                        â”‚
Representam os dados      â”‚                        â”‚
do sistema                â”‚                        â”‚
                          â”‚                        â”‚
                          â”‚  User Actions          â”‚
                          â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
                          â”‚                        â”‚
                          â”‚                        â”‚ Process
                          â”‚                        â”‚ Business
                          â”‚                        â”‚ Logic
                          â”‚                        â”‚
                          â”‚  Update View           â”‚
                          â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
                          â”‚                        â”‚
                                                   â”‚
                                                   â”‚
                                                   â–¼
                                           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                           â”‚   Services    â”‚
                                           â”‚   & DAOs      â”‚
                                           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                   â”‚
                                                   â–¼
                                           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                           â”‚   Data        â”‚
                                           â”‚   Sources     â”‚
                                           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

SEPARAÃ‡ÃƒO DE RESPONSABILIDADES:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Model:      O QUE sÃ£o os dados
View:       COMO exibir para o usuÃ¡rio
Controller: QUANDO e COMO processar
Services:   ONDE buscar/processar dados
DAOs:       COMO persistir dados
```

---

**Este arquivo contÃ©m diagramas ASCII para referÃªncia rÃ¡pida.**  
**Para diagramas profissionais, consulte os arquivos .puml e DIAGRAMAS_MERMAID.md**

**VersÃ£o**: 1.0  
**Data**: Novembro 2025
